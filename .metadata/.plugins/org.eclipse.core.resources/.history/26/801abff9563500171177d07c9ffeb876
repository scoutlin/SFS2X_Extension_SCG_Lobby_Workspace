package scott.scg.mongodb;

import java.util.Arrays;
import java.util.List;

import org.bson.Document;

import com.mongodb.MongoClient;
import com.mongodb.client.MongoCollection;
import com.mongodb.client.MongoDatabase;

public class TestMongoCommands
{
	private static TestMongoCommands mTestMongoCommands;
	
	public TestMongoCommands TestMongoCommands()
	{
		if(mTestMongoCommands == null)
		{
			mTestMongoCommands = new TestMongoCommands();
			return mTestMongoCommands;
		}
		else
		{
			return mTestMongoCommands;
		}	
	}
	
	public String AddCollecion(String collectionName)
	{
		MongoDatabase database_scg = MongoClientScottAtlas.GetInstance().getDatabase("scg");
		
		database_scg.createCollection("AddCollecion");
		
		MongoCollection<Document> mMongoCollection = database_scg.getCollection(collectionName);
		
		return Long.toString(mMongoCollection.count());
	}
	
	public String DropCollection(String collectionName)
	{
		MongoDatabase database_scg = MongoClientScottAtlas.GetInstance().getDatabase("scg");
		
		MongoCollection<Document> mMongoCollection = database_scg.getCollection(collectionName);
		
		mMongoCollection.drop();
		
		return Long.toString(mMongoCollection.count());
	}
	
	public String AddDocument(String documentName)
	{
		MongoDatabase database_scg = MongoClientScottAtlas.GetInstance().getDatabase("scg");
		
		MongoCollection<Document> mMongoCollection = database_scg.getCollection(documentName);
		
		List<String> mPigList = Arrays.asList("aaa", "bbb");
		mPigList.add("ccc");
		mPigList.add("ddd");
		
		Object mObject = new Object();

		Document doc = new Document("_id_quickLogin", "QL0000000000000000")
                .append("_password", "guest")
                .append("_id_fbLogin",    "FB0000000000000000")
                .append("_FB_token_long", "")
				.append("_SHA_key", "")
				.append("mPigList", mPigList)
				.append("mObject", mObject);
		
		mMongoCollection.get
		
		return Long.toString(mMongoCollection.count());
	}
	
	public String UpdateDocument()
	{
		return null;
	}
	
	public String DeleteDocument()
	{
		return null;
	}
	 
}
